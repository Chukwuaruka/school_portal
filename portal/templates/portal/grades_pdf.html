<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>{{ student_name }} - Report Card</title>
<style>
  @page {
    size: A4 portrait;
    margin: 6mm 8mm;
  }
  body {
    font-family: Arial, Helvetica, sans-serif;
    font-size: 7.5px;
    margin: 0;
    padding: 3px;
    background: #fff;
    color: #000;
    line-height: 1.15;
  }
  .container { max-width: 100%; margin: 0 auto; }

  /* HEADER TABLE FOR PDF COMPATIBILITY */
  .header-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 9px;
    border-bottom: 2px solid #000;
    padding-bottom: 6px;
  }
  .header-table td {
    vertical-align: top;
    padding: 4px;
    border: none;
  }
  .left-col {
    width: 35%;
    text-align: left;
    line-height: 1.5;
  }
  .center-col {
    width: 30%;
    text-align: center;
  }
  .right-col {
    width: 35%;
    text-align: left;
    font-size: 9px;
    line-height: 1.4;
    color: #2e3563;
  }
  .student-name {
    font-size: 11px;
    color: black;
  }

  .school-name {
    color: #c41e3a;
    font-size: 19px;
    font-weight: bold;
    margin: 0;
    line-height: 1.1;
  }
  .school-type { font-size: 8px; margin: 2px 0; }
  .address, .contact { color: #c41e3a; font-weight: bold; margin: 1px 0; font-size: 7px;}

  .logo { width: 70px; margin: 2px auto; display: block; }
  .motto {
    font-weight: bold;
    font-size: 7px;
    margin: 2px 0;
    color: #2088bd;
  }
  .report-title {
    font-weight: bold;
    font-size: 7px;
    margin: 0;
    color: #294f16;
  }

  table.grades {
    width: 100%;
    border-collapse: collapse;
    margin: 4px 0;
    font-size: 8px;
  }

  table.grades th, table.grades td {
    border: 1px solid #000;
    padding: 4px 1px;
    text-align: center;
  }
  
  /* Make comment column wider */
  table.grades td:last-child,
  table.grades th:last-child {
    min-width: 120px;
    width: 15%;
  }
  table.grades th { background-color: #f0f0f0; font-weight: bold; line-height: 1.1; }
  .subject { text-align: left !important; padding-left: 3px !important; }
  .yellow { background-color: #ffff99 !important; font-weight: bold; }

  .grade-key {
    width: 100%;
    font-size: 6px;
    line-height: 1.3;
    text-align: left;
    padding: 2px;
  }

  .summary-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 8px;
    font-size: 10px;
  }
  .summary-table td {
    width: 50%;
    border: 2px solid #000;
    padding: 6px;
    vertical-align: top;
    line-height: 1.5;
  }

  .behavioural {
    margin-top: 6px;
    padding: 5px;
    border: 2px solid #c41e3a;
    background-color: #fff5f5;
    font-size: 9px;
    color: #d00;
    font-weight: bold;
    line-height: 1.4;
  }

  @media print {
    body { padding: 3px; }
  }
</style>
</head>
<body>

<div class="container">

  <!-- HEADER TABLE (PDF-SAFE 3 COLUMN LAYOUT) -->
  <table class="header-table">
    <tr>
      <!-- LEFT: School Info -->
      <td class="left-col">
        <h1 class="school-name">PEN ARK SCHOOLS</h1>
        <p class="school-type">CRECHE, PREPRIMARY, PRIMARY & COLLEGE</p>
        <p class="address">9/11 EDUN STREET LADIPO, OSHODI LAGOS</p>
        <p class="contact">TEL: 09063550663; 08063616032</p>
        <p class="contact">EMAIL: pen-arkschools119@gmail.com</p>
      </td>

      <!-- CENTER: Logo + Motto + Title -->
      <td class="center-col">
        <img src="https://pen-arkschools.com/img/logo.jpg" alt="PEN ARK Logo" class="logo">
        <p class="motto">MOTTO: TRAINED FOR DUTY & FOR THEE<br>(GOVERNMENT APPROVED)</p>
        <p class="report-title">{{ report.term|upper }} ASSESSMENT<br>SESSION {{ report.session }}</p>
      </td>

      <!-- RIGHT: Student Profile -->
      <td class="right-col">
        <strong class="student-name">STUDENT PROFILE:</strong> {{ student_profile.profile_id }}<br>
        <strong>NAME:</strong> {{ student_profile.name }}<br>
        <strong>NATIONALITY:</strong> {{ student_profile.nationality }}<br>
        <strong>CLASS:</strong> {{ student_profile.classroom }} <strong style="margin-left: 15px;">SEX:</strong> {{ student_profile.sex }}<br>
        <strong>HEIGHT:</strong> {{ student_profile.height }} <strong style="margin-left: 15px;">WEIGHT:</strong> {{ student_profile.weight }}<br>
        <strong>TIME PRESENT/ABSENT:</strong> {{ student_profile.time_present }}
      </td>
    </tr>
  </table>

  <!-- Results Table -->
  <table class="grades">
    <thead>
      <tr>
        <th colspan="10">RECORDS OF TESTS AND EXAMINATION</th>
        <th rowspan="3">
          <div class="grade-key">
            <strong>GRADE KEY:</strong><br>
            90%+ (A*) Outstanding<br>
            80-89% (A) Excellent<br>
            70-79% (B) V. Good<br>
            60-69% (C) Good<br>
            50-59% (D) Fair<br>
            40-49% (E) Weak<br>
            0-39% (F) Fail
          </div>
        </th>
      </tr>
      <tr>
        <th rowspan="2">SUBJECT</th>
        <th colspan="4">MARKS</th>
        <th colspan="4">TERMLY SUMMARY</th>
        <th rowspan="3">GRD</th>
      </tr>
      <tr>
        <th>1st<br>20</th>
        <th>2nd<br>20</th>
        <th>EXM<br>60</th>
        <th>TOT<br>100</th>
        <th>1st<br>100</th>
        <th>2nd<br>100</th>
        <th>3rd<br>100</th>
        <th>AVG<br>%</th>
      </tr>
      <tr>
        <th>MAX MARKS</th>
        <th>20</th><th>20</th><th>60</th><th>100</th>
        <th>100</th><th>100</th><th>100</th><th>100%</th>
        <th>COMMENT & TEACHER</th>
      </tr>
    </thead>
    <tbody>
      {% for subject in grades %}
      <tr>
        <td class="subject">{{ subject.subject }}</td>
        <td>{{ subject.first_test|default:"-" }}</td>
        <td>{{ subject.second_test|default:"-" }}</td>
        <td>{{ subject.exam|default:"-" }}</td>
        <td class="yellow">{{ subject.total_score|default:"-" }}</td>
        <td>{{ subject.first_term_score|default:subject.total_score|default:"-" }}</td>
        <td>{{ subject.second_term_score|default:"-" }}</td>
        <td>{{ subject.third_term_score|default:"-" }}</td>
        <td>{{ subject.average_score|default:subject.total_score|default:"-" }}</td>
        <td>{{ subject.grade|default:"-" }}</td>
        <td class="subject">{{ subject.grade_comment|default:"" }} - {{ subject.teacher|default:"" }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Summary & Comments (Table Layout for PDF) -->
  <table class="summary-table">
    <tr>
      <td>
        <strong>TOTAL AVAILABLE SCORE:</strong> {{ report.total_available_score|default:"" }}<br>
        <strong>STUDENT OVERALL SCORE:</strong> {{ report.overall_score|default:"" }}<br>
        <strong>STUDENT OVERALL AVERAGE:</strong> {{ report.overall_average|default:"" }}%<br>
        <strong>OVERALL POSITION:</strong> {{ report.overall_position|default:"" }}
      </td>
      <td>
        <strong>TEACHER'S COMMENT:</strong> {{ report.teacher_comment|default:"" }}<br>
        <strong>DATE:</strong> {{ report.date_uploaded|date:"d/m/Y" }} <strong style="margin-left: 10px;">NEXT TERM:</strong> {% if report.next_term_date %}{{ report.next_term_date|date:"d/m/Y" }}{% endif %}<br><br>
        <strong>ADMINISTRATOR'S COMMENT:</strong> {{ report.admin_comment_report|default:"" }}<br><br>
        <strong>SIGN:</strong> ____________________
      </td>
    </tr>
  </table>

  <!-- Behavioural Skills -->
  <div class="behavioural">
    <strong>BEHAVIOURAL SKILL KEY: EXCELLENT(5) HIGH(4) ACCEPTABLE(3) MINIMUM(2) NO REGARD(1)</strong><br>
    {% for skill in behavioural_skills %}
    <strong>{{ skill.skill_name|upper }}({{ skill.rating }})</strong>{% if not forloop.last %} &nbsp; {% endif %}
    {% endfor %}
  </div>

</div>
</body>
</html>